{"version":3,"sources":["../../../src/home/controller/yqb.js"],"names":["indexAction","display","configAction","helpAction","writeconfigAction","base_css","post","css","base_js","js","c","concat","j","tpl","stbuiTemplate","domain","appName","version","framework","coverFormat","cwd","process","writeFileSync","json","options","path","think","RESOURCE_PATH","result","readFileSync","replace","arr","isEmpty","data","map","value","join"],"mappings":"AAAA;;;;;;;;;;;;;;;;AAEA;;;;AACA;;;;;;;;;;;;;;AAGI;;;;qBAIAA,W,0BAAc;;AAEV,eAAO,KAAKC,OAAL,EAAP;AACH,K;;qBAEDC,Y,2BAAe;AACX,eAAO,KAAKD,OAAL,EAAP;AACH,K;;qBAEDE,U,yBAAa;AACT,eAAO,KAAKF,OAAL,EAAP;AACH,K;;qBAEDG,iB,gCAAoB;AAChB,YAAMC,WAAW,KAAKC,IAAL,CAAU,UAAV,CAAjB;AACA,YAAMC,MAAM,KAAKD,IAAL,CAAU,KAAV,CAAZ;AACA,YAAME,UAAU,KAAKF,IAAL,CAAU,SAAV,CAAhB;AACA,YAAMG,KAAK,KAAKH,IAAL,CAAU,IAAV,CAAX;;AAEA,YAAII,IAAIL,SAASM,MAAT,CAAgBJ,GAAhB,CAAR;AACA,YAAIK,IAAIJ,QAAQG,MAAR,CAAeF,EAAf,CAAR;;AAEA,YAAII,MAAM,KAAKC,aAAL,CAAmB;AACzBC,oBAAQ,2CADiB;AAEzBC,qBAAS,EAFgB;AAGzBC,qBAAS,cAHgB;AAIzBC,uBAAW,KAAKC,WAAL,CAAiBP,CAAjB;AAJc,SAAnB,CAAV;;AAOA;AACA,YAAIQ,MAAMC,QAAQD,GAAR,KAAgB,gBAA1B;AACA,qBAAGE,aAAH,CAAiBF,GAAjB,EAAsBP,GAAtB,EAA2B,OAA3B;;AAEA,aAAKU,IAAL,CAAUV,GAAV;AACH,K;;qBAEDC,a,0BAAcU,O,EAAS;AACnB,YAAIC,OAAOC,MAAMC,aAAN,GAAsB,mBAAjC;;AAEA,YAAIC,SAAS,aAAGC,YAAH,CAAgBJ,IAAhB,EAAsB,OAAtB,CAAb;AACAG,iBAASA,OACJE,OADI,CACI,aADJ,EACmBN,QAAQT,MAD3B,EAEJe,OAFI,CAEI,cAFJ,EAEoBN,QAAQP,OAF5B,EAGJa,OAHI,CAGI,cAHJ,EAGoBN,QAAQR,OAH5B,EAIJc,OAJI,CAII,gBAJJ,EAIsBN,QAAQN,SAJ9B,CAAT;;AAOA,eAAOU,MAAP;AACH,K;;qBAEDT,W,wBAAYY,G,EAAK;AACb,YAAIL,MAAMM,OAAN,CAAcD,GAAd,CAAJ,EAAwB;AACpB,mBAAO,mBAAP;AACH;;AAED,YAAIE,OAAOF,IAAIG,GAAJ,CAAQ,iBAAQ;AACvB,mBAAO,eAAeC,KAAf,GAAuB,OAA9B;AACH,SAFU,CAAX;;AAIA,eAAO,MAAMF,KAAKG,IAAL,CAAU,GAAV,CAAN,GAAuB,GAA9B;AACH,K","file":"yqb.js","sourcesContent":["'use strict';\r\n\r\nimport Base from './base.js';\r\nimport fs from 'fs';\r\n\r\nexport default class extends Base {\r\n    /**\r\n     * index action\r\n     * @return {Promise} []\r\n     */\r\n    indexAction() {\r\n\r\n        return this.display();\r\n    }\r\n\r\n    configAction() {\r\n        return this.display();\r\n    }\r\n\r\n    helpAction() {\r\n        return this.display();\r\n    }\r\n\r\n    writeconfigAction() {\r\n        const base_css = this.post('base_css');\r\n        const css = this.post('css');\r\n        const base_js = this.post('base_js');\r\n        const js = this.post('js');\r\n\r\n        let c = base_css.concat(css);\r\n        let j = base_js.concat(js);\r\n\r\n        let tpl = this.stbuiTemplate({\r\n            domain: 'http://emres.dfcfw.com/stock/201610121223',\r\n            appName: '',\r\n            version: '201610121223',\r\n            framework: this.coverFormat(j)\r\n        });\r\n\r\n        // 写入到执行命令行的目录下\r\n        let cwd = process.cwd() + '/stbui.conf.js';\r\n        fs.writeFileSync(cwd, tpl, 'utf-8');\r\n\r\n        this.json(tpl);\r\n    }\r\n\r\n    stbuiTemplate(options) {\r\n        let path = think.RESOURCE_PATH + '/static/config.js';\r\n\r\n        let result = fs.readFileSync(path, 'utf-8');\r\n        result = result\r\n            .replace(/{{domain}}/g, options.domain)\r\n            .replace(/{{version}}/g, options.version)\r\n            .replace(/{{appName}}/g, options.appName)\r\n            .replace(/{{framework}}/g, options.framework)\r\n        ;\r\n\r\n        return result;\r\n    }\r\n\r\n    coverFormat(arr) {\r\n        if (think.isEmpty(arr)) {\r\n            return 'framework/**/*.js';\r\n        }\r\n\r\n        let data = arr.map(value=> {\r\n            return 'framework/' + value + '/*.js';\r\n        });\r\n\r\n        return \"{\" + data.join(',') + \"}\";\r\n    }\r\n}"]}